matrix:
  include:
    - language: node_js
      node_js:
        - "9"

      before_script:
        - curl -sL https://deb.nodesource.com/setup_9.x | sudo -E bash -
        - sudo apt-get install -y nodejs
        - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
        - echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
        - sudo apt-get update
        - sudo apt-get install yarn -y
        - sudo yarn global add coveralls
        - yarn global add gulp
        - sudo apt install make
        - sudo apt install g++
        - cd src/client
        - yarn add git+https://github.com/CodeChillAlluna/xterm.js.git
        - yarn install
        - cd node_modules/xterm
        - npm install
        - cd ../..

      script:
        - yarn build
      after_success: 
        - yarn test --coverage && cat ./coverage/lcov.info | coveralls

    - language: java
      jdk: oraclejdk8

    services:
      - docker

      sudo: required
      before_script:
        - sudo apt-get install -y maven
        - sudo apt-get install -y python-dev
        - sudo apt-get install -y libpq-dev
        - sudo service postgresql restart
        - sudo sh install/db.sh
        - sudo sh install/docker.sh
        - cd src/spring

      script:
        - sudo sh mvnw clean package
      after_success:
        - sudo sh mvnw clean test -DTRAVIS_JOB_ID=$TRAVIS_JOB_ID jacoco:report coveralls:report
        
notifications:
email: false